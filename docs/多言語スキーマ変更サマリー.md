# å¤šè¨€èªå¯¾å¿œ: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ä¸€è¦§

**ä½œæˆæ—¥**: 2025-11-21
**ç›®çš„**: å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤‰æ›´å†…å®¹ã‚’ä¸€è¦§ã§æŠŠæ¡

---

## å¤‰æ›´å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§

| # | ãƒ†ãƒ¼ãƒ–ãƒ«å | ã‚«ãƒ†ã‚´ãƒª | å„ªå…ˆåº¦ | å¤šè¨€èªã‚«ãƒ©ãƒ æ•° | ç¿»è¨³æ–¹å¼ |
|---|-----------|---------|--------|--------------|---------|
| 1 | cards | ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ | ğŸ”´ é«˜ | 2 | ç®¡ç†è€…ä½œæˆæ™‚ |
| 2 | packs | ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ | ğŸ”´ é«˜ | 1 | ç®¡ç†è€…ä½œæˆæ™‚ |
| 3 | deck_pages | ç®¡ç†è€…ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸ”´ é«˜ | 17 | ç®¡ç†è€…ä½œæˆæ™‚ |
| 4 | info_pages | ç®¡ç†è€…ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸ”´ é«˜ | 17 | ç®¡ç†è€…ä½œæˆæ™‚ |
| 5 | info_articles | ç®¡ç†è€…ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸ”´ é«˜ | 7 | ç®¡ç†è€…ä½œæˆæ™‚ |
| 6 | info_article_blocks | ç®¡ç†è€…ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸ”´ é«˜ | 1 | ç®¡ç†è€…ä½œæˆæ™‚ |
| 7 | tournaments | ç®¡ç†è€…ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸŸ¡ ä¸­ | 2 | ç®¡ç†è€…ä½œæˆæ™‚ |
| 8 | deck_notifications | é€šçŸ¥ | ğŸŸ¡ ä¸­ | 1 | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ |
| 9 | trade_notifications | é€šçŸ¥ | ğŸŸ¡ ä¸­ | 1 | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ |
| 10 | decks | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸŸ¢ ä½ | 2 + status | ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ |
| 11 | trade_posts | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸŸ¢ ä½ | 4 + status | ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ |
| 12 | trade_owned_list | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸŸ¢ ä½ | 1 + status | ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ |
| 13 | user_collages | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ğŸŸ¢ ä½ | 2 + status | ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ |
| 14 | trade_comments | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | âšª ç‰¹æ®Š | 0 | **éƒ½åº¦ç¿»è¨³** |
| 15 | users | ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç† | - | 0 | **å¤‰æ›´ä¸è¦** |

**æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«**: translation_cache, translation_jobs

---

## 1. cardsï¼ˆã‚«ãƒ¼ãƒ‰ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ 

| æ–°ã‚«ãƒ©ãƒ å | å‹ | NOT NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|-----|---------|-----------|------|
| name_multilingual | JSONB | âœ… | `'{"ja":""}'::jsonb` | ã‚«ãƒ¼ãƒ‰åï¼ˆå…¨è¨€èªï¼‰ |
| image_url_multilingual | JSONB | âœ… | `'{}'::jsonb` | ã‚«ãƒ¼ãƒ‰ç”»åƒURLï¼ˆè¨€èªãƒ»åœ°åŸŸåˆ¥ï¼‰ |

### æ—¢å­˜ãƒ‡ãƒ¼ã‚¿å¤‰æ›

```sql
UPDATE cards SET
    name_multilingual = jsonb_build_object('ja', name),
    image_url_multilingual = jsonb_build_object('ja', image_url, 'en', image_url, 'zh-CN', image_url, 'zh-TW', image_url, 'ko', image_url);
```

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_cards_name_multilingual` (GIN)
- `idx_cards_image_url_multilingual` (GIN)

### å‚™è€ƒ
- `poke2_name`ã¯å»ƒæ­¢äºˆå®šã®ãŸã‚å¯¾å¿œä¸è¦
- ç®¡ç†è€…ãŒã‚«ãƒ¼ãƒ‰ä½œæˆæ™‚ã«å…¨è¨€èªã‚’å…¥åŠ›ã¾ãŸã¯è‡ªå‹•ç¿»è¨³

---

## 2. packsï¼ˆãƒ‘ãƒƒã‚¯ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ 

| æ–°ã‚«ãƒ©ãƒ å | å‹ | NOT NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|-----|---------|-----------|------|
| name_multilingual | JSONB | âœ… | `'{"ja":""}'::jsonb` | ãƒ‘ãƒƒã‚¯åï¼ˆå…¨è¨€èªï¼‰ |

### æ—¢å­˜ãƒ‡ãƒ¼ã‚¿å¤‰æ›

```sql
UPDATE packs SET name_multilingual = jsonb_build_object('ja', name);
```

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_packs_name_multilingual` (GIN)

---

## 3. deck_pagesï¼ˆãƒ‡ãƒƒã‚­ã‚¬ã‚¤ãƒ‰ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ17å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | æ—¢å­˜ã‚«ãƒ©ãƒ  | èª¬æ˜ |
|-----------|-----|----------|------|
| title_multilingual | JSONB | title | ã‚¿ã‚¤ãƒˆãƒ« |
| thumbnail_image_url_multilingual | JSONB | thumbnail_image_url | ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒURL |
| thumbnail_alt_multilingual | JSONB | thumbnail_alt | ã‚µãƒ ãƒã‚¤ãƒ«alt |
| deck_badge_multilingual | JSONB | deck_badge | ãƒ‡ãƒƒã‚­ãƒãƒƒã‚¸ |
| section1_title_multilingual | JSONB | section1_title | ã‚»ã‚¯ã‚·ãƒ§ãƒ³1ã‚¿ã‚¤ãƒˆãƒ« |
| deck_name_multilingual | JSONB | deck_name | ãƒ‡ãƒƒã‚­å |
| energy_image_url_multilingual | JSONB | energy_image_url | ã‚¨ãƒãƒ«ã‚®ãƒ¼ç”»åƒURL |
| deck_cards_multilingual | JSONB | deck_cards | ãƒ‡ãƒƒã‚­ã‚«ãƒ¼ãƒ‰ä¸€è¦§ï¼ˆJSONBï¼‰ |
| deck_description_multilingual | JSONB | deck_description | ãƒ‡ãƒƒã‚­èª¬æ˜ |
| evaluation_title_multilingual | JSONB | evaluation_title | è©•ä¾¡ã‚¿ã‚¤ãƒˆãƒ« |
| tier_rank_multilingual | JSONB | tier_rank | ãƒ†ã‚£ã‚¢ãƒ©ãƒ³ã‚¯ |
| tier_name_multilingual | JSONB | tier_name | ãƒ†ã‚£ã‚¢å |
| tier_descriptions_multilingual | JSONB | tier_descriptions | ãƒ†ã‚£ã‚¢èª¬æ˜ï¼ˆé…åˆ—ï¼‰ |
| section2_title_multilingual | JSONB | section2_title | ã‚»ã‚¯ã‚·ãƒ§ãƒ³2ã‚¿ã‚¤ãƒˆãƒ« |
| strengths_weaknesses_details_multilingual | JSONB | strengths_weaknesses_details | å¼·ã¿ãƒ»å¼±ã¿è©³ç´°ï¼ˆJSONBï¼‰ |
| section3_title_multilingual | JSONB | section3_title | ã‚»ã‚¯ã‚·ãƒ§ãƒ³3ã‚¿ã‚¤ãƒˆãƒ« |
| how_to_play_steps_multilingual | JSONB | how_to_play_steps | ä½¿ã„æ–¹æ‰‹é †ï¼ˆJSONBï¼‰ |

### å¤šè¨€èªåŒ–ä¸è¦ãªã‚«ãƒ©ãƒ 

- âŒ `stat_accessibility`, `stat_speed`, `stat_power`, `stat_durability`, `stat_stability` - æ•°å€¤
- âŒ `is_published`, `view_count`, `like_count`, `favorite_count`, `eval_value`, `eval_count` - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
- âŒ `category` - ENUMï¼ˆi18nã§ç¿»è¨³ï¼‰

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_deck_pages_title_multilingual` (GIN)
- `idx_deck_pages_deck_cards_multilingual` (GIN)
- `idx_deck_pages_strengths_multilingual` (GIN)
- `idx_deck_pages_howto_multilingual` (GIN)

### ç‰¹è¨˜äº‹é …

**JSONBæ§‹é€ ã®å¤šè¨€èªåŒ–ä¾‹**:

```json
// deck_cards_multilingual
{
  "ja": [{"card_id": 4762, "pack_name": "æœªçŸ¥ãªã‚‹æ°´åŸŸ", "card_count": 2, "display_order": 0}],
  "en": [{"card_id": 4762, "pack_name": "Unknown Depths", "card_count": 2, "display_order": 0}]
}

// strengths_weaknesses_details_multilingual
{
  "ja": [{"title": "ãƒ™ãƒ³ãƒã‚’ä¸¦ã¹ã¦ç«åŠ›ã‚’å‡ºã™", "image_urls": [...], "description": "<p>...</p>", "display_order": 1}],
  "en": [{"title": "Build your bench for power", "image_urls": [...], "description": "<p>...</p>", "display_order": 1}]
}
```

---

## 4. info_pagesï¼ˆè¨˜äº‹ãƒšãƒ¼ã‚¸ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ 

**deck_pagesã¨åŒã˜17å€‹ã®ã‚«ãƒ©ãƒ **ã‚’è¿½åŠ 

### å‚™è€ƒ
- info_pagesã¨deck_pagesã¯åŒã˜ã‚¹ã‚­ãƒ¼ãƒæ§‹é€ 
- å°†æ¥çš„ã«ãƒ†ãƒ¼ãƒ–ãƒ«çµ±åˆã¾ãŸã¯ç”¨é€”åˆ¥æœ€é©åŒ–ã‚’æ¤œè¨

---

## 5. info_articlesï¼ˆè¨˜äº‹ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ7å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | æ—¢å­˜ã‚«ãƒ©ãƒ  | èª¬æ˜ |
|-----------|-----|----------|------|
| slug_multilingual | JSONB | slug | URLã‚¹ãƒ©ãƒƒã‚° |
| title_multilingual | JSONB | title | ã‚¿ã‚¤ãƒˆãƒ« |
| subtitle_multilingual | JSONB | subtitle | ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ« |
| excerpt_multilingual | JSONB | excerpt | æŠœç²‹ |
| thumbnail_image_url_multilingual | JSONB | thumbnail_image_url | ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒURL |
| hero_image_url_multilingual | JSONB | hero_image_url | ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒURL |
| tags_multilingual | JSONB | tags | ã‚¿ã‚°ï¼ˆé…åˆ—ï¼‰ |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_info_articles_title_multilingual` (GIN)
- `idx_info_articles_slug_multilingual` (GIN)
- `idx_info_articles_tags_multilingual` (GIN)

### å¤šè¨€èªåŒ–ä¸è¦

- âŒ `category` - ENUM
- âŒ `is_published`, `published_at`, `pinned`, `priority` - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
- âŒ `view_count`, `like_count`, `favorite_count`, `comment_count` - çµ±è¨ˆ
- âŒ `author_id` - å‚ç…§

---

## 6. info_article_blocksï¼ˆè¨˜äº‹ãƒ–ãƒ­ãƒƒã‚¯ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ1å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | æ—¢å­˜ã‚«ãƒ©ãƒ  | èª¬æ˜ |
|-----------|-----|----------|------|
| data_multilingual | JSONB | data | ãƒ–ãƒ­ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ï¼ˆå…¨ã‚¿ã‚¤ãƒ—ï¼‰ |

### dataæ§‹é€ ã®å¤šè¨€èªåŒ–

å„ãƒ–ãƒ­ãƒƒã‚¯ã‚¿ã‚¤ãƒ—ã”ã¨ã«dataå†…ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ç¿»è¨³:

| type | dataæ§‹é€ ä¾‹ | ç¿»è¨³å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ |
|------|-----------|-----------------|
| heading | `{"level": 2, "text": "è¦‹å‡ºã—"}` | `text` |
| paragraph | `{"text": "æ®µè½ãƒ†ã‚­ã‚¹ãƒˆ"}` | `text` |
| image | `{"url": "...", "caption": "..."}` | `caption` |
| list | `{"style": "bulleted", "items": ["é …ç›®1", "é …ç›®2"]}` | `items[]` |
| table | `{"headers": ["åˆ—1"], "rows": [["ãƒ‡ãƒ¼ã‚¿"]]}` | `headers[]`, `rows[][]` |
| rich-text | `{"content": "<p>...</p>"}` | `content` |
| callout | `{"type": "info", "content": "..."}` | `content` |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_info_article_blocks_data_multilingual` (GIN)

### å¤šè¨€èªåŒ–ä¸è¦

- âŒ `article_id`, `display_order`, `type` - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿

---

## 7. tournamentsï¼ˆå¤§ä¼šæƒ…å ±ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ2å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | æ—¢å­˜ã‚«ãƒ©ãƒ  | èª¬æ˜ |
|-----------|-----|----------|------|
| title_multilingual | JSONB | title | å¤§ä¼šã‚¿ã‚¤ãƒˆãƒ« |
| benefit_multilingual | JSONB | benefit | ç‰¹å…¸ |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_tournaments_title_multilingual` (GIN)

### å¤šè¨€èªåŒ–ä¸è¦

- âŒ `event_date`, `is_online`, `detail_url`, `is_published` - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿

---

## 8. deck_notificationsï¼ˆãƒ‡ãƒƒã‚­é€šçŸ¥ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ1å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | æ—¢å­˜ã‚«ãƒ©ãƒ  | èª¬æ˜ |
|-----------|-----|----------|------|
| content_multilingual | JSONB | content | é€šçŸ¥å†…å®¹ |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_deck_notifications_content_multilingual` (GIN)

### å®Ÿè£…æ–¹æ³•

é€šçŸ¥ä½œæˆæ™‚ã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰å…¨è¨€èªç‰ˆã‚’ç”Ÿæˆ:
```typescript
const templates = {
  comment: {
    ja: "{{user}}ã•ã‚“ãŒã‚³ãƒ¡ãƒ³ãƒˆã—ã¾ã—ãŸ",
    en: "{{user}} commented",
    "zh-CN": "{{user}}è¯„è®ºäº†",
    "zh-TW": "{{user}}è©•è«–äº†",
    ko: "{{user}}ë‹˜ì´ ëŒ“ê¸€ì„ ë‚¨ê²¼ìŠµë‹ˆë‹¤"
  }
};
```

---

## 9. trade_notificationsï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‰é€šçŸ¥ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ1å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | æ—¢å­˜ã‚«ãƒ©ãƒ  | èª¬æ˜ |
|-----------|-----|----------|------|
| content_multilingual | JSONB | content | é€šçŸ¥å†…å®¹ |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_trade_notifications_content_multilingual` (GIN)

### å®Ÿè£…æ–¹æ³•

deck_notificationsã¨åŒæ§˜ã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ–¹å¼

---

## 10. decksï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆãƒ‡ãƒƒã‚­ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ4å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | NOT NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|-----|---------|-----------|------|
| title_multilingual | JSONB | âŒ | NULL | ãƒ‡ãƒƒã‚­ã‚¿ã‚¤ãƒˆãƒ« |
| description_multilingual | JSONB | âŒ | NULL | ãƒ‡ãƒƒã‚­èª¬æ˜ |
| translation_status | TEXT | âŒ | 'pending' | ç¿»è¨³çŠ¶æ…‹ |
| auto_translated_at | TIMESTAMPTZ | âŒ | NULL | è‡ªå‹•ç¿»è¨³å®Œäº†æ—¥æ™‚ |

### åˆ¶ç´„

```sql
ALTER TABLE decks
ADD CONSTRAINT check_translation_status
CHECK (translation_status IN ('pending', 'processing', 'completed', 'failed'));
```

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_decks_title_multilingual` (GIN)
- `idx_decks_translation_status` (BTREE)

### ç¿»è¨³æ–¹å¼

**ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ç¿»è¨³**:
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‡ãƒƒã‚­ä½œæˆ/æ›´æ–°
2. `translation_jobs`ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¸ãƒ§ãƒ–ç™»éŒ²
3. ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒé †æ¬¡å‡¦ç†
4. å®Œäº†å¾Œ`translation_status`ã‚’'completed'ã«æ›´æ–°

---

## 11. trade_postsï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‰æŠ•ç¨¿ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ5å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | NOT NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|-----|---------|-----------|------|
| title_multilingual | JSONB | âŒ | NULL | æŠ•ç¨¿ã‚¿ã‚¤ãƒˆãƒ« |
| comment_multilingual | JSONB | âŒ | NULL | ã‚³ãƒ¡ãƒ³ãƒˆ |
| wanted_card_id_multilingual | JSONB | âŒ | NULL | æ±‚ã‚ã‚‹ã‚«ãƒ¼ãƒ‰ï¼ˆJSONBé…åˆ—ï¼‰ |
| offered_card_id_multilingual | JSONB | âŒ | NULL | è­²ã‚Œã‚‹ã‚«ãƒ¼ãƒ‰ï¼ˆJSONBé…åˆ—ï¼‰ |
| translation_status | TEXT | âŒ | 'pending' | ç¿»è¨³çŠ¶æ…‹ |

### åˆ¶ç´„

```sql
ALTER TABLE trade_posts
ADD CONSTRAINT check_trade_translation_status
CHECK (translation_status IN ('pending', 'processing', 'completed', 'failed'));
```

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_trade_posts_title_multilingual` (GIN)
- `idx_trade_posts_translation_status` (BTREE)

### ç‰¹è¨˜äº‹é …

**wanted_card_id / offered_card_id ã®æ§‹é€ **:
```json
// æ—¢å­˜ï¼ˆæ—¥æœ¬èªã®ã¿ï¼‰
[
  {"id": 123, "name": "ãƒ”ã‚«ãƒãƒ¥ã‚¦ex", "imageUrl": "..."},
  {"id": 456, "name": "ãƒŸãƒ¥ã‚¦ãƒ„ãƒ¼ex", "imageUrl": "..."}
]

// å¤šè¨€èªåŒ–å¾Œ
{
  "ja": [{"id": 123, "name": "ãƒ”ã‚«ãƒãƒ¥ã‚¦ex", "imageUrl": "..."}],
  "en": [{"id": 123, "name": "Pikachu ex", "imageUrl": "..."}]
}
```

---

## 12. trade_owned_listï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ2å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | NOT NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|-----|---------|-----------|------|
| list_name_multilingual | JSONB | âŒ | NULL | ãƒªã‚¹ãƒˆå |
| translation_status | TEXT | âŒ | 'pending' | ç¿»è¨³çŠ¶æ…‹ |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_trade_owned_list_translation_status` (BTREE)

### å¤šè¨€èªåŒ–ä¸è¦

- âŒ `card_ids[]` - ã‚«ãƒ¼ãƒ‰IDã®é…åˆ—ï¼ˆè¨€èªéä¾å­˜ï¼‰

---

## 13. user_collagesï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ©ãƒ¼ã‚¸ãƒ¥ï¼‰

### è¿½åŠ ã‚«ãƒ©ãƒ ï¼ˆ3å€‹ï¼‰

| æ–°ã‚«ãƒ©ãƒ å | å‹ | NOT NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|-----|---------|-----------|------|
| title1_multilingual | JSONB | âŒ | NULL | ã‚¿ã‚¤ãƒˆãƒ«1ï¼ˆæ±‚ã‚ã‚‹ã‚«ãƒ¼ãƒ‰ï¼‰ |
| title2_multilingual | JSONB | âŒ | NULL | ã‚¿ã‚¤ãƒˆãƒ«2ï¼ˆè­²ã‚Œã‚‹ã‚«ãƒ¼ãƒ‰ï¼‰ |
| translation_status | TEXT | âŒ | 'pending' | ç¿»è¨³çŠ¶æ…‹ |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

- `idx_user_collages_translation_status` (BTREE)

### å¤šè¨€èªåŒ–ä¸è¦

- âŒ `card_ids_1[]`, `card_ids_2[]` - ã‚«ãƒ¼ãƒ‰IDã®é…åˆ—
- âŒ `collage_image_url`, `collage_storage_path` - ç”»åƒURL/ãƒ‘ã‚¹

---

## 14. trade_commentsï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‰ã‚³ãƒ¡ãƒ³ãƒˆï¼‰âš ï¸ ç‰¹æ®Š

### è¿½åŠ ã‚«ãƒ©ãƒ 

**ãªã— - éƒ½åº¦ç¿»è¨³æ–¹å¼ã‚’æ¡ç”¨**

### ç¾çŠ¶

- ã‚³ãƒ¡ãƒ³ãƒˆæ•°: **285,292ä»¶**
- ç·æ–‡å­—æ•°: **ç´„683ä¸‡æ–‡å­—**
- å…¨ç¿»è¨³ã‚³ã‚¹ãƒˆ: **$410**

### æ¡ç”¨æ–¹é‡: éƒ½åº¦ç¿»è¨³ï¼ˆã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ç¿»è¨³ï¼‰

**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯ç¿»è¨³ã‚’ä¿å­˜ã—ãªã„**

### å®Ÿè£…æ–¹æ³•

1. **UIã«ã€Œç¿»è¨³ã€ãƒœã‚¿ãƒ³ã‚’è¿½åŠ **
2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¯ãƒªãƒƒã‚¯æ™‚ã«`/api/translate-comment`å‘¼ã³å‡ºã—
3. APIã¯`translation_cache`ã‚’ç¢ºèª
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚ã‚Š â†’ ã™ãè¿”å´
   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã— â†’ AWS Translateã§ç¿»è¨³ â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä¿å­˜ â†’ è¿”å´
4. **ä»£æ›¿æ¡ˆ**: ãƒ–ãƒ©ã‚¦ã‚¶æ¨™æº–ã®è‡ªå‹•ç¿»è¨³æ©Ÿèƒ½

### ãƒ¡ãƒªãƒƒãƒˆ

- âœ… åˆæœŸã‚³ã‚¹ãƒˆ: **$0**
- âœ… å®Ÿéš›ã«é–²è¦§ã•ã‚Œã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã®ã¿ç¿»è¨³
- âœ… ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç¯€ç´„
- âœ… translation_cacheã§å†åˆ©ç”¨å¯èƒ½

---

## 15. usersï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼‰

### å¤‰æ›´å†…å®¹

**å¤‰æ›´ä¸è¦**

è¨€èªè¨­å®šã¯åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ`user-language-detection-options.md`ï¼‰å‚ç…§

---

## æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«

### translation_cacheï¼ˆç¿»è¨³ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰

```sql
CREATE TABLE translation_cache (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    source_text TEXT NOT NULL,
    source_language TEXT NOT NULL,
    target_language TEXT NOT NULL,
    translated_text TEXT NOT NULL,
    service_used TEXT NOT NULL,
    char_count INTEGER NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    last_accessed_at TIMESTAMPTZ DEFAULT NOW(),
    access_count INTEGER DEFAULT 1,
    UNIQUE(source_text, source_language, target_language)
);
```

**ç”¨é€”**: ç¿»è¨³çµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦ã‚³ã‚¹ãƒˆå‰Šæ¸›

---

### translation_jobsï¼ˆç¿»è¨³ã‚¸ãƒ§ãƒ–ï¼‰

```sql
CREATE TABLE translation_jobs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    entity_type TEXT NOT NULL,
    entity_id TEXT NOT NULL,
    source_language TEXT NOT NULL,
    target_languages TEXT[] NOT NULL,
    status TEXT NOT NULL DEFAULT 'pending',
    priority INTEGER DEFAULT 0,
    service TEXT,
    error_message TEXT,
    retry_count INTEGER DEFAULT 0,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    started_at TIMESTAMPTZ,
    completed_at TIMESTAMPTZ,
    UNIQUE(entity_type, entity_id, status)
);
```

**ç”¨é€”**: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ç¿»è¨³ã‚¸ãƒ§ãƒ–ã®ç®¡ç†

---

## ã‚µãƒãƒªãƒ¼çµ±è¨ˆ

### ã‚«ãƒ©ãƒ è¿½åŠ æ•°

| ã‚«ãƒ†ã‚´ãƒª | ãƒ†ãƒ¼ãƒ–ãƒ«æ•° | å¤šè¨€èªã‚«ãƒ©ãƒ ç·æ•° |
|---------|----------|--------------|
| ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ | 2 | 3 |
| ç®¡ç†è€…ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | 5 | 44 |
| é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ  | 2 | 2 |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | 4 | 13 + 4 status |
| **åˆè¨ˆ** | **13** | **66** |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ æ•°

- **GINã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: ç´„45å€‹
- **BTREEã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: ç´„8å€‹
- **åˆè¨ˆ**: ç´„53å€‹

### ç¿»è¨³æ–¹å¼åˆ¥

| ç¿»è¨³æ–¹å¼ | ãƒ†ãƒ¼ãƒ–ãƒ«æ•° | èª¬æ˜ |
|---------|----------|------|
| ç®¡ç†è€…ä½œæˆæ™‚ | 7 | ä½œæˆãƒ»æ›´æ–°æ™‚ã«å…¨è¨€èªç¿»è¨³ |
| ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ | 4 | ã‚¸ãƒ§ãƒ–ã‚­ãƒ¥ãƒ¼ã§é †æ¬¡ç¿»è¨³ |
| ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ | 2 | é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ç”Ÿæˆ |
| éƒ½åº¦ç¿»è¨³ | 1 | ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ±‚æ™‚ã®ã¿ç¿»è¨³ |
| å¤‰æ›´ä¸è¦ | 1 | users |

---

## å®Ÿè£…å„ªå…ˆé †ä½

### Phase 1: ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆ1-2æ—¥ï¼‰
1. âœ… cards
2. âœ… packs

### Phase 2: ç®¡ç†è€…ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆ1é€±é–“ï¼‰
3. âœ… deck_pages
4. âœ… info_pages
5. âœ… info_articles
6. âœ… info_article_blocks
7. âœ… tournaments

### Phase 3: é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ2-3æ—¥ï¼‰
8. âœ… deck_notifications
9. âœ… trade_notifications

### Phase 4: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆ1é€±é–“ï¼‰
10. âœ… translation_cacheï¼ˆæ–°è¦ï¼‰
11. âœ… translation_jobsï¼ˆæ–°è¦ï¼‰
12. âœ… decks
13. âœ… trade_posts
14. âœ… trade_owned_list
15. âœ… user_collages

### Phase 5: ç‰¹æ®Šå¯¾å¿œï¼ˆ3-4æ—¥ï¼‰
16. âœ… trade_commentsï¼ˆéƒ½åº¦ç¿»è¨³UIå®Ÿè£…ï¼‰

---

## è¦‹ç©ã‚‚ã‚Š

### é–‹ç™ºå·¥æ•°

| Phase | å·¥æ•° | æ‹…å½“ |
|-------|------|------|
| Phase 1 | 1-2æ—¥ | DB + Backend |
| Phase 2 | 5-7æ—¥ | DB + Backend + ç®¡ç†ç”»é¢ |
| Phase 3 | 2-3æ—¥ | Backend |
| Phase 4 | 5-7æ—¥ | Backend + Worker |
| Phase 5 | 3-4æ—¥ | Frontend |
| **åˆè¨ˆ** | **16-23æ—¥** | |

### åˆæœŸç¿»è¨³ã‚³ã‚¹ãƒˆ

| é …ç›® | ã‚³ã‚¹ãƒˆ |
|------|--------|
| ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ | $1.29 |
| ç®¡ç†è€…ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | $42.00 |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆäººæ°—ã®ã¿ï¼‰ | $15.00 |
| trade_comments | $0ï¼ˆéƒ½åº¦ç¿»è¨³ï¼‰ |
| **åˆè¨ˆ** | **$58.29** |

### æœˆé–“ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚³ã‚¹ãƒˆ

| é …ç›® | æœˆé¡ |
|------|------|
| æ–°è¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç¿»è¨³ | $3.00 |
| æ›´æ–°ãƒ»ä¿®æ­£ | $1.20 |
| éƒ½åº¦ç¿»è¨³ï¼ˆcommentsï¼‰ | $0.60 |
| **åˆè¨ˆ** | **$4.80** |

---

## ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- [ ] å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®ALTER TABLEå®Ÿè¡Œ
- [ ] ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆï¼ˆ53å€‹ï¼‰
- [ ] åˆ¶ç´„è¿½åŠ ï¼ˆCHECKåˆ¶ç´„ï¼‰
- [ ] æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸå¤‰æ›
- [ ] æ–°è¦ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆï¼ˆtranslation_cache, translation_jobsï¼‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- [ ] AWS Translate APIçµ±åˆ
- [ ] ç¿»è¨³APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
- [ ] ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¯ãƒ¼ã‚«ãƒ¼å®Ÿè£…
- [ ] translation_cache CRUDå®Ÿè£…
- [ ] translation_jobsç®¡ç†æ©Ÿèƒ½

### ç®¡ç†ç”»é¢
- [ ] å¤šè¨€èªå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ å®Ÿè£…
- [ ] ä½œæˆæ™‚è‡ªå‹•ç¿»è¨³æ©Ÿèƒ½
- [ ] ç¿»è¨³ã‚¸ãƒ§ãƒ–ç›£è¦–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- [ ] å¤šè¨€èªãƒ†ã‚­ã‚¹ãƒˆå–å¾—ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
- [ ] è¨€èªåˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
- [ ] trade_commentsã€Œç¿»è¨³ã€ãƒœã‚¿ãƒ³å®Ÿè£…
- [ ] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»ã‚¨ãƒ©ãƒ¼è¡¨ç¤º

### ãƒ†ã‚¹ãƒˆ
- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ï¼‰
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆAPIï¼‰
- [ ] E2Eãƒ†ã‚¹ãƒˆï¼ˆè¨€èªåˆ‡ã‚Šæ›¿ãˆï¼‰
- [ ] è² è·ãƒ†ã‚¹ãƒˆï¼ˆç¿»è¨³APIï¼‰

### ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
- [ ] ç¿»è¨³APIã‚³ã‚¹ãƒˆè¿½è·¡
- [ ] ç¿»è¨³ã‚¸ãƒ§ãƒ–å‡¦ç†çŠ¶æ³
- [ ] ã‚¨ãƒ©ãƒ¼é€šçŸ¥è¨­å®š
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
