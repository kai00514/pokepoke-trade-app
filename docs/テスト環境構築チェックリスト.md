# テスト環境構築チェックリスト

**対象ブランチ**: `feature/i18n-test-environment`
**所要時間**: 約2-3時間

---

## ✅ Phase 1: Supabase準備（30分）

### Supabaseテストプロジェクト作成
- [ ] https://app.supabase.com にログイン
- [ ] 新規プロジェクト作成: `pokepoke-i18n-test`
- [ ] Region選択: Northeast Asia (Tokyo)
- [ ] Database Passwordを記録
- [ ] プロジェクト初期化完了を待つ（5-10分）

### 認証情報の取得
- [ ] Project Settings > API を開く
- [ ] `Project URL` をコピー
- [ ] `anon public` key をコピー
- [ ] これらを安全な場所に保存

### データベース設定（オプション）
- [ ] SQL Editorで本番スキーマをコピー
- [ ] または pg_dump/restore でデータ移行
- [ ] テストデータを投入（必要に応じて）

---

## ✅ Phase 2: Vercel設定（15分）

### プレビュー環境変数の設定
- [ ] https://vercel.com/dashboard を開く
- [ ] プロジェクト `pokepoke-trade-app` を選択
- [ ] Settings > Environment Variables を開く

### 環境変数を追加（Environment: Preview）
```
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGc...
NEXT_PUBLIC_ENV=test
```

- [ ] `NEXT_PUBLIC_SUPABASE_URL` を入力
- [ ] `NEXT_PUBLIC_SUPABASE_ANON_KEY` を入力
- [ ] `NEXT_PUBLIC_ENV=test` を入力
- [ ] Environment: **Preview** を選択
- [ ] Git Branch: `feature/i18n-test-environment` を指定
- [ ] Save ボタンをクリック

---

## ✅ Phase 3: ローカル環境設定（10分）

### 環境変数ファイル作成
```bash
cp .env.local .env.local.test
```

- [ ] `.env.local.test` を作成
- [ ] Supabase URL を更新
- [ ] Supabase Anon Key を更新
- [ ] `NEXT_PUBLIC_ENV=test` を追加

### テスト用環境変数に切り替え
```bash
cp .env.local.test .env.local
```

- [ ] `.env.local` をテスト用に上書き
- [ ] または手動で編集

---

## ✅ Phase 4: i18nライブラリのインストール（5分）

### パッケージインストール
```bash
pnpm add next-intl
```

- [ ] `pnpm add next-intl` を実行
- [ ] インストール完了を確認

---

## ✅ Phase 5: i18n設定ファイル作成（30分）

### 必要なファイルを作成
- [ ] `/i18n.ts` - i18n設定
- [ ] `/middleware.ts` - ルーティング設定
- [ ] `/app/[locale]/layout.tsx` - ロケール対応レイアウト

### ファイル作成コマンド
```bash
# i18n.ts を作成（手順書の内容をコピー）
touch i18n.ts

# middleware.ts を作成
touch middleware.ts

# [locale] ディレクトリを作成
mkdir -p app/[locale]
```

### 既存ファイルの移動
```bash
# 既存のレイアウト・ページを[locale]配下に移動
mv app/layout.tsx app/[locale]/layout.tsx
mv app/page.tsx app/[locale]/page.tsx

# その他のディレクトリも移動
mv app/auth app/[locale]/auth
mv app/trades app/[locale]/trades
mv app/lists app/[locale]/lists
mv app/collages app/[locale]/collages
mv app/contact app/[locale]/contact
mv app/decks app/[locale]/decks
mv app/favorites app/[locale]/favorites
mv app/history app/[locale]/history
mv app/info app/[locale]/info
mv app/matching app/[locale]/matching
mv app/content app/[locale]/content

# apiディレクトリは移動しない（言語に依存しないため）
```

- [ ] 全てのページディレクトリを`[locale]`配下に移動
- [ ] `app/api`は移動しない
- [ ] `app/loading.tsx`, `app/error.tsx`等も移動

---

## ✅ Phase 6: 言語切り替えコンポーネント作成（15分）

### コンポーネントファイル作成
```bash
touch components/language-switcher.tsx
```

- [ ] `components/language-switcher.tsx` を作成
- [ ] 手順書のコード例をコピー
- [ ] ヘッダーコンポーネントに追加

### ヘッダーに統合
```typescript
// components/layout/header.tsx
import LanguageSwitcher from '@/components/language-switcher';

// ヘッダー内に追加
<LanguageSwitcher />
```

- [ ] `components/layout/header.tsx` を編集
- [ ] LanguageSwitcherを追加

---

## ✅ Phase 7: ローカルテスト（20分）

### 開発サーバー起動
```bash
pnpm dev
```

- [ ] `pnpm dev` を実行
- [ ] エラーがないか確認

### ブラウザで確認
- [ ] http://localhost:3000 を開く（日本語）
- [ ] http://localhost:3000/en を開く（英語）
- [ ] http://localhost:3000/zh-cn を開く（中国語）
- [ ] 言語切り替えが動作するか確認
- [ ] ページ遷移時に言語が保持されるか確認
- [ ] コンソールエラーがないか確認

---

## ✅ Phase 8: Gitコミット & プッシュ（10分）

### 変更をコミット
```bash
git add .
git status  # 変更内容を確認

git commit -m "feat: setup i18n with next-intl

- Add i18n configuration files
- Setup middleware for locale routing
- Move app structure to [locale] directory
- Add language switcher component
- Configure test environment

🤖 Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>"
```

- [ ] `git add .` を実行
- [ ] 変更内容を確認
- [ ] コミットメッセージを作成
- [ ] コミット実行

### リモートにプッシュ
```bash
git push -u origin feature/i18n-test-environment
```

- [ ] `git push` を実行
- [ ] GitHubでブランチが作成されたか確認

---

## ✅ Phase 9: Vercelデプロイ確認（10分）

### Vercel Dashboard確認
- [ ] https://vercel.com/dashboard を開く
- [ ] Deployments タブを開く
- [ ] `feature/i18n-test-environment` のデプロイを確認
- [ ] Building... から Ready に変わるまで待つ（3-5分）
- [ ] デプロイログを確認

### プレビューURLでテスト
- [ ] デプロイ完了後、Visit ボタンをクリック
- [ ] プレビューURLを開く（例: https://pokepoke-xxx.vercel.app）
- [ ] トップページが表示されるか確認
- [ ] 言語切り替えが動作するか確認
- [ ] `/en`, `/zh-cn` 等の言語URLが動作するか確認
- [ ] Supabase接続が正常か確認（ログイン等）

---

## ✅ Phase 10: 動作テスト（20分）

### 基本機能テスト
- [ ] トップページ表示
- [ ] ナビゲーションメニュー表示
- [ ] 言語切り替え動作
- [ ] ページ遷移（各言語）

### 認証テスト
- [ ] ログインページ表示（各言語）
- [ ] サインアップページ表示（各言語）
- [ ] エラーメッセージ表示（各言語）

### フォームテスト
- [ ] トレード投稿作成（各言語）
- [ ] リスト作成（各言語）
- [ ] バリデーションメッセージ（各言語）

### モバイルテスト
- [ ] スマートフォンで表示確認
- [ ] タブレットで表示確認
- [ ] レスポンシブデザイン確認

---

## ✅ Phase 11: 翻訳作業（オプション・時間により実施）

### 英語翻訳（最優先）
- [ ] `locales/en/common.json` を翻訳
- [ ] `locales/en/auth.json` を翻訳
- [ ] `locales/en/forms.json` を翻訳
- [ ] `locales/en/errors.json` を翻訳
- [ ] `locales/en/messages.json` を翻訳
- [ ] `locales/en/pages.json` を翻訳
- [ ] `locales/en/cards.json` を翻訳

### その他の言語（時間があれば）
- [ ] 中国語簡体字（zh-cn）
- [ ] 中国語繁体字（zh-tw）
- [ ] その他の言語

### 翻訳方法
- [ ] 手動翻訳
- [ ] または DeepL API使用
- [ ] または AWS Translate使用

---

## ✅ Phase 12: 最終確認

### ドキュメント確認
- [ ] `docs/テスト環境構築手順.md` を読む
- [ ] `docs/i18nファイル作成完了サマリー.md` を読む
- [ ] 不明点がないか確認

### テスト環境の状態確認
- [ ] Supabaseテストプロジェクトが稼働中
- [ ] Vercelプレビュー環境がデプロイ済み
- [ ] ローカル開発環境が動作中
- [ ] 全ての設定ファイルが正しく配置

### 次のステップ
- [ ] チームメンバーに共有
- [ ] フィードバック収集
- [ ] 必要に応じて修正
- [ ] 本番環境へのマージ準備

---

## 🚨 トラブルシューティング

### ビルドエラーが出る
```bash
rm -rf node_modules .next
pnpm install
pnpm build
```

### 言語が切り替わらない
- Middlewareの設定を確認
- ブラウザのキャッシュをクリア
- ハードリロード（Cmd+Shift+R）

### Supabase接続エラー
- 環境変数を再確認
- Vercelの環境変数設定を確認
- Supabaseプロジェクトのステータス確認

### デプロイが失敗する
- Vercelのデプロイログを確認
- ビルドエラーを修正
- 環境変数の設定を確認

---

## 📝 完了後の確認事項

### 全てのチェック項目が完了したら
- [ ] このチェックリストを保存
- [ ] 作業ログを記録
- [ ] 次の担当者に引き継ぎ（必要に応じて）

### 記録すべき情報
- Supabase Project URL: `_________________`
- Vercel Preview URL: `_________________`
- 作業完了日時: `_________________`
- 所要時間: `_________________`
- 問題点・改善点: `_________________`

---

**参考ドキュメント**:
- `docs/テスト環境構築手順.md` - 詳細な手順書
- `docs/i18nファイル作成完了サマリー.md` - i18n実装の概要
- `docs/多言語対応設計.md` - 設計ドキュメント

**作成日**: 2025-11-22
