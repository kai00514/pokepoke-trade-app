# ãƒ†ã‚¹ãƒˆç’°å¢ƒé‹ç”¨ã‚¬ã‚¤ãƒ‰

**ä½œæˆæ—¥**: 2025-11-22
**å¯¾è±¡ãƒ–ãƒ©ãƒ³ãƒ**: `feature/i18n-test-environment`

---

## ğŸ‰ æ§‹ç¯‰å®Œäº†ã—ãŸç’°å¢ƒ

### Supabase Preview Branch
- **Branchå**: `dev-feature-i18n`
- **Project ID**: `oflucnwezzqqtxryonhf`
- **URL**: https://oflucnwezzqqtxryonhf.supabase.co
- **Dashboard**: https://supabase.com/dashboard/project/oflucnwezzqqtxryonhf

### Vercel Previewç’°å¢ƒ
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: `pokepoke-trade-app`
- **Preview URL**: https://pokepoke-trade-3w5se5edr-kkais-projects-0fd0e023.vercel.app
- **Dashboard**: https://vercel.com/kkais-projects-0fd0e023/pokepoke-trade-app

### GitHub
- **ãƒ–ãƒ©ãƒ³ãƒ**: `feature/i18n-test-environment`
- **ãƒªãƒã‚¸ãƒˆãƒª**: https://github.com/kai00514/pokepoke-trade-app

---

## ğŸ“‹ ä»Šå¾Œã®é–‹ç™ºãƒ•ãƒ­ãƒ¼

### 1. ãƒ­ãƒ¼ã‚«ãƒ«ã§é–‹ç™º

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
pnpm dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª
open http://localhost:3000
```

### 2. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ

```bash
# å¤‰æ›´ã‚’ç¢ºèª
git status

# å¤‰æ›´ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°
git add .

# ã‚³ãƒŸãƒƒãƒˆ
git commit -m "feat: æ©Ÿèƒ½ã®èª¬æ˜"
```

### 3. GitHubã«ãƒ—ãƒƒã‚·ãƒ¥

```bash
# ãƒªãƒ¢ãƒ¼ãƒˆã«ãƒ—ãƒƒã‚·ãƒ¥
git push origin feature/i18n-test-environment
```

### 4. è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ç¢ºèª

ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã¨è‡ªå‹•çš„ã«ï¼š
1. VercelãŒè‡ªå‹•ãƒ“ãƒ«ãƒ‰é–‹å§‹ï¼ˆç´„2-3åˆ†ï¼‰
2. æ–°ã—ã„Preview URLãŒç”Ÿæˆã•ã‚Œã‚‹
3. Slackã‚„ãƒ¡ãƒ¼ãƒ«ã§é€šçŸ¥ï¼ˆè¨­å®šã—ã¦ã„ã‚‹å ´åˆï¼‰

**ç¢ºèªæ–¹æ³•**:
- https://vercel.com/kkais-projects-0fd0e023/pokepoke-trade-app/deployments

### 5. ãƒ†ã‚¹ãƒˆç’°å¢ƒã§å‹•ä½œç¢ºèª

æœ€æ–°ã®Preview URLã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ç¢ºèª

---

## ğŸ”§ ã‚ˆãã‚ã‚‹ä½œæ¥­

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã‚’ãƒ†ã‚¹ãƒˆDBã«æ¥ç¶š

ç¾åœ¨ã®`.env.local`ã¯ã™ã§ã«Preview Branchã«è¨­å®šæ¸ˆã¿ï¼š

```env
NEXT_PUBLIC_SUPABASE_URL=https://oflucnwezzqqtxryonhf.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGc...
```

### æœ¬ç•ªDBã«æˆ»ã™å ´åˆ

```bash
# .env.localã‚’ç·¨é›†ã—ã¦æœ¬ç•ªã®èªè¨¼æƒ…å ±ã«æˆ»ã™
# ã¾ãŸã¯åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã¦åˆ‡ã‚Šæ›¿ãˆ
cp .env.local.production .env.local
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å†…å®¹ã‚’ç¢ºèª

```bash
# Supabase Dashboard
https://supabase.com/dashboard/project/oflucnwezzqqtxryonhf/editor

# ã¾ãŸã¯CLI
supabase db dump --project-ref oflucnwezzqqtxryonhf
```

### æœ€æ–°ã®æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã§æ›´æ–°

Preview Branchã®ãƒ‡ãƒ¼ã‚¿ã‚’æœ€æ–°ã®æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã§ä¸Šæ›¸ãï¼š

```bash
# 1. æœ¬ç•ªDBã‹ã‚‰ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
pg_dump "æœ¬ç•ªã®POSTGRES_URL" --no-owner --no-acl --schema=public -f /tmp/latest.sql

# 2. Preview Branchã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
psql "postgresql://postgres:iZVIKuRfhhGmplxwjduVeUWLEiTisaui@db.oflucnwezzqqtxryonhf.supabase.co:5432/postgres" < /tmp/latest.sql
```

---

## ğŸš€ i18nå®Ÿè£…ã®é€²ã‚æ–¹

### Phase 1: åŸºæœ¬ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆå®Œäº†æ¸ˆã¿ï¼‰

âœ… i18nãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼ˆ63ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
âœ… æ—¥æœ¬èªç‰ˆï¼ˆãƒã‚¹ã‚¿ãƒ¼ï¼‰ä½œæˆ
âœ… ãƒ†ã‚¹ãƒˆç’°å¢ƒæ§‹ç¯‰

### Phase 2: next-intlå®Ÿè£…ï¼ˆæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰

#### 2-1. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pnpm add next-intl
```

#### 2-2. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

**`i18n.ts`** (ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ)

```typescript
import { getRequestConfig } from 'next-intl/server';

export const locales = ['ja', 'en', 'zh-cn', 'zh-tw', 'pt-br', 'fr', 'it', 'de', 'es'] as const;
export type Locale = (typeof locales)[number];
export const defaultLocale: Locale = 'ja';

export default getRequestConfig(async ({ locale }) => {
  return {
    messages: (await import(`./locales/${locale}/common.json`)).default
  };
});
```

**`middleware.ts`** (ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ)

```typescript
import createMiddleware from 'next-intl/middleware';
import { locales, defaultLocale } from './i18n';

export default createMiddleware({
  locales,
  defaultLocale,
  localePrefix: 'as-needed'
});

export const config = {
  matcher: ['/((?!api|_next|_vercel|.*\\..*).*)']
};
```

#### 2-3. ã‚¢ãƒ—ãƒªæ§‹é€ ã‚’å¤‰æ›´

```bash
# [locale] ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p app/\[locale\]

# æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç§»å‹•ï¼ˆapiãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥å¤–ï¼‰
mv app/layout.tsx app/\[locale\]/layout.tsx
mv app/page.tsx app/\[locale\]/page.tsx

# ãã®ä»–ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚‚ç§»å‹•
mv app/auth app/\[locale\]/auth
mv app/trades app/\[locale\]/trades
# (ä»¥ä¸‹åŒæ§˜)
```

#### 2-4. layout.tsxã‚’æ›´æ–°

```typescript
import { NextIntlClientProvider } from 'next-intl';
import { notFound } from 'next/navigation';
import { locales } from '@/i18n';

export default async function LocaleLayout({
  children,
  params: { locale }
}: {
  children: React.ReactNode;
  params: { locale: string };
}) {
  if (!locales.includes(locale as any)) {
    notFound();
  }

  const messages = (await import(`@/locales/${locale}/common.json`)).default;

  return (
    <html lang={locale}>
      <body>
        <NextIntlClientProvider locale={locale} messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}
```

#### 2-5. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§i18nã‚’ä½¿ç”¨

```typescript
'use client';
import { useTranslations } from 'next-intl';

export default function MyComponent() {
  const t = useTranslations();

  return (
    <div>
      <h1>{t('pages.home.title')}</h1>
      <button>{t('buttons.login')}</button>
    </div>
  );
}
```

#### 2-6. ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥

```bash
git add .
git commit -m "feat: implement next-intl basic setup"
git push origin feature/i18n-test-environment
```

### Phase 3: ç¿»è¨³ä½œæ¥­

#### å„ªå…ˆé †ä½

1. **è‹±èª** (en) - ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘
2. **ä¸­å›½èªç°¡ä½“å­—** (zh-cn) - ã‚¢ã‚¸ã‚¢å¸‚å ´å‘ã‘
3. **ãã®ä»–è¨€èª** - å¿…è¦ã«å¿œã˜ã¦

#### ç¿»è¨³æ–¹æ³•

**æ‰‹å‹•ç¿»è¨³**:
```bash
# locales/en/common.json ã‚’é–‹ã„ã¦ç¿»è¨³
code locales/en/common.json
```

**è‡ªå‹•ç¿»è¨³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ** (ã‚ªãƒ—ã‚·ãƒ§ãƒ³):
```bash
# ç¿»è¨³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦ä¸€æ‹¬ç¿»è¨³
# (DeepL API, Google Translate APIãªã©ã‚’ä½¿ç”¨)
```

### Phase 4: ãƒ†ã‚¹ãƒˆ

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã§å„è¨€èªã‚’ãƒ†ã‚¹ãƒˆ
pnpm dev

# ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª
open http://localhost:3000     # æ—¥æœ¬èª
open http://localhost:3000/en  # è‹±èª
```

**ç¢ºèªé …ç›®**:
- [ ] å…¨ãƒšãƒ¼ã‚¸ã§è¨€èªãŒæ­£ã—ãè¡¨ç¤º
- [ ] è¨€èªåˆ‡ã‚Šæ›¿ãˆãŒå‹•ä½œ
- [ ] URLã«è¨€èªã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã‚‹
- [ ] ãƒªãƒ­ãƒ¼ãƒ‰æ™‚ã‚‚è¨€èªãŒä¿æŒã•ã‚Œã‚‹
- [ ] èªè¨¼ãƒ•ãƒ­ãƒ¼ãŒæ­£å¸¸
- [ ] ãƒ•ã‚©ãƒ¼ãƒ ãŒæ­£å¸¸å‹•ä½œ

### Phase 5: æœ¬ç•ªç’°å¢ƒã¸ã®ãƒãƒ¼ã‚¸

#### Pull Requestä½œæˆ

```bash
# GitHubä¸Šã§PRä½œæˆ
# Base: main
# Compare: feature/i18n-test-environment
```

#### ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾Œãƒãƒ¼ã‚¸

```bash
# mainãƒ–ãƒ©ãƒ³ãƒã«åˆ‡ã‚Šæ›¿ãˆ
git checkout main

# æœ€æ–°ã‚’å–å¾—
git pull origin main

# feature/i18n-test-environmentã‚’å‰Šé™¤ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
git branch -d feature/i18n-test-environment
```

---

## âš ï¸ æ³¨æ„äº‹é …

### ãƒ†ã‚¹ãƒˆç’°å¢ƒã®åˆ¶é™

1. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**
   - Preview Branchã®ãƒ‡ãƒ¼ã‚¿ã¯æœ¬ç•ªã¨åˆ†é›¢
   - ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§è‡ªç”±ã«å®Ÿé¨“å¯èƒ½
   - æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã«ã¯å½±éŸ¿ãªã—

2. **èªè¨¼**
   - Google OAuthã®è¨­å®šãŒå¿…è¦
   - ãƒ†ã‚¹ãƒˆç’°å¢ƒç”¨ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURLè¨­å®š

3. **Storage**
   - ç”»åƒãªã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯æœ¬ç•ªã¨åˆ†é›¢
   - å¿…è¦ã«å¿œã˜ã¦æ‰‹å‹•ã‚³ãƒ”ãƒ¼

### ã‚³ã‚¹ãƒˆ

- **Supabase Preview Branch**: ä½¿ç”¨ã—ãŸåˆ†ã ã‘èª²é‡‘
- **Vercel Preview**: ç„¡æ–™æ å†…ï¼ˆé€šå¸¸ã¯å•é¡Œãªã—ï¼‰

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- `.env.local`ã¯Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„
- ç’°å¢ƒå¤‰æ•°ã¯Vercel Dashboardã§ç®¡ç†
- ã‚µãƒ¼ãƒ“ã‚¹ãƒ­ãƒ¼ãƒ«ã‚­ãƒ¼ã¯æ…é‡ã«æ‰±ã†

---

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã§ç¢ºèª
pnpm build

# ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
rm -rf node_modules .next
pnpm install
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¤±æ•—ã™ã‚‹

1. Vercel Dashboardã§ãƒ­ã‚°ã‚’ç¢ºèª
2. ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ã®è©³ç´°ã‚’ç¢ºèª

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

```bash
# ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
echo $NEXT_PUBLIC_SUPABASE_URL
echo $NEXT_PUBLIC_SUPABASE_ANON_KEY

# Supabase BranchãŒç¨¼åƒä¸­ã‹ç¢ºèª
https://supabase.com/dashboard/project/oflucnwezzqqtxryonhf
```

### è¨€èªãŒåˆ‡ã‚Šæ›¿ã‚ã‚‰ãªã„

1. ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
2. ãƒãƒ¼ãƒ‰ãƒªãƒ­ãƒ¼ãƒ‰ï¼ˆCmd+Shift+Rï¼‰
3. Middlewareã®è¨­å®šã‚’ç¢ºèª

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

### è³ªå•ãƒ»å•é¡Œå ±å‘Š

- GitHub Issues
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆSlack
- æ‹…å½“è€…ã«ç›´æ¥é€£çµ¡

### å‚è€ƒè³‡æ–™

- [next-intl Documentation](https://next-intl-docs.vercel.app/)
- [Supabase Branching](https://supabase.com/docs/guides/platform/branching)
- [Vercel Preview Deployments](https://vercel.com/docs/concepts/deployments/preview-deployments)

---

## ğŸ“Š é€²æ—ç®¡ç†

### ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

#### Phase 2: next-intlå®Ÿè£…
- [ ] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] i18n.ts ä½œæˆ
- [ ] middleware.ts ä½œæˆ
- [ ] appæ§‹é€ ã‚’[locale]é…ä¸‹ã«ç§»å‹•
- [ ] layout.tsxæ›´æ–°
- [ ] è¨€èªåˆ‡ã‚Šæ›¿ãˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‡ãƒ—ãƒ­ã‚¤ç¢ºèª

#### Phase 3: ç¿»è¨³
- [ ] è‹±èªç¿»è¨³ï¼ˆå„ªå…ˆï¼‰
- [ ] ä¸­å›½èªç°¡ä½“å­—ç¿»è¨³
- [ ] ãã®ä»–è¨€èªç¿»è¨³

#### Phase 4: ãƒ†ã‚¹ãƒˆ
- [ ] å…¨è¨€èªã§ãƒšãƒ¼ã‚¸è¡¨ç¤ºç¢ºèª
- [ ] èªè¨¼ãƒ•ãƒ­ãƒ¼ç¢ºèª
- [ ] ãƒ•ã‚©ãƒ¼ãƒ å‹•ä½œç¢ºèª
- [ ] ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºç¢ºèª

#### Phase 5: æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹
- [ ] Pull Requestä½œæˆ
- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼
- [ ] ãƒãƒ¼ã‚¸
- [ ] æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] æœ¬ç•ªç’°å¢ƒå‹•ä½œç¢ºèª

---

**ä½œæˆè€…**: Claude Code
**æœ€çµ‚æ›´æ–°**: 2025-11-22
